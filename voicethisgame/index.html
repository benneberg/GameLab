<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Manual Mic Recorder</title>
  <style>
    body { font-family: sans-serif; text-align: center; padding: 2em; }
    button { padding: 0.6em 1.2em; margin: 0.5em; font-size: 1.1em; }
  </style>
</head>
<body>

  <h1>Record Game Sounds</h1>
  <p id="status">Tap the button below to begin.</p>
  <button id="startBtn">Enable Microphone</button>

  <div id="recordUI" style="display: none;">
    <div>
      <h3>Jump Sound</h3>
      <button onclick="startRecording('jump')">Start Recording</button>
      <button onclick="stopRecording()">Stop Recording</button>
      <button onclick="play('jump')">Play Jump</button>
    </div>
    <div>
      <h3>Slide Sound</h3>
      <button onclick="startRecording('slide')">Start Recording</button>
      <button onclick="stopRecording()">Stop Recording</button>
      <button onclick="play('slide')">Play Slide</button>
    </div>
  </div>

  <script>
    let stream;
    let mediaRecorder;
    let currentLabel = '';
    const sounds = {};

    document.getElementById("startBtn").addEventListener("click", () => {
      navigator.mediaDevices.getUserMedia({ audio: true })
        .then(s => {
          stream = s;
          document.getElementById("recordUI").style.display = "block";
          document.getElementById("status").textContent = "Microphone ready!";
        })
        .catch(err => {
          console.error(err);
          document.getElementById("status").textContent = "Microphone access failed.";
        });
    });

    function startRecording(label) {
      if (!stream) return alert("Microphone not ready.");
      currentLabel = label;
      const chunks = [];

      const mimeType = MediaRecorder.isTypeSupported('audio/mp4') ? 'audio/mp4' : 'audio/webm';
mediaRecorder = new MediaRecorder(stream, { mimeType });
      mediaRecorder.ondataavailable = e => chunks.push(e.data);
      mediaRecorder.onstop = () => {
  const blob = new Blob(chunks, { type: mediaRecorder.mimeType });
  console.log("Blob recorded:", blob);
  sounds[label] = URL.createObjectURL(blob);
  alert(`Recorded "${label}" sound.`);
};

      mediaRecorder.start();
      console.log("Recording started:", label);
    }

    function stopRecording() {
      if (!mediaRecorder || mediaRecorder.state !== "recording") {
        alert("Nothing is being recorded.");
        return;
      }
      mediaRecorder.stop();
      console.log("Recording stopped:", currentLabel);
    }
console.log("Opening recorded blob in new tab...");
window.open(sounds[label]);
    function play(label) {
      if (!sounds[label]) return alert(`No sound recorded for "${label}".`);
      new Audio(sounds[label]).play();
    }
  </script>
</body>
</html>
