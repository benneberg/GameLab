<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Mic Game Test</title>
  <style>
    body { font-family: sans-serif; text-align: center; padding: 2em; }
    button { padding: 0.6em 1.2em; margin: 0.5em; font-size: 1.1em; }
  </style>
</head>
<body>

  <h1>Record Game Sounds</h1>
  <p id="status">Tap the button below to begin.</p>
  <button id="startBtn">Enable Microphone</button>

  <div id="recordUI" style="display: none;">
    <button onclick="record('jump')">Record Jump</button>
    <button onclick="record('slide')">Record Slide</button>
    <button onclick="play('jump')">Play Jump</button>
    <button onclick="play('slide')">Play Slide</button>
  </div>

  <script>
    let mediaRecorder;
    let stream;
    const sounds = {};

    document.getElementById("startBtn").addEventListener("click", () => {
      navigator.mediaDevices.getUserMedia({ audio: true })
        .then(s => {
          stream = s;
          document.getElementById("recordUI").style.display = "block";
          document.getElementById("status").textContent = "Microphone access granted!";
        })
        .catch(err => {
          console.error(err);
          document.getElementById("status").textContent = "Mic access denied.";
        });
    });

    function record(label) {
      if (!stream) return alert("Mic not ready!");

      const chunks = [];
      mediaRecorder = new MediaRecorder(stream);

      mediaRecorder.ondataavailable = e => {
        if (e.data.size > 0) chunks.push(e.data);
      };

      mediaRecorder.onstop = () => {
        const blob = new Blob(chunks, { type: "audio/webm" });
        sounds[label] = URL.createObjectURL(blob);
        alert(`Recorded "${label}" sound!`);
      };

      mediaRecorder.start();
      setTimeout(() => mediaRecorder.stop(), 1000);
    }

    function play(label) {
      if (!sounds[label]) return alert(`No sound recorded for "${label}"`);
      new Audio(sounds[label]).play();
    }
  </script>
</body>
</html>
